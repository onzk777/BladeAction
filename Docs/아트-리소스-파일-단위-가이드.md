# 아트 리소스 파일 단위 가이드

## 개요

이 문서는 BladeAction 프로젝트에서 Spine 애니메이션 리소스의 파일 단위와 구조를 정의합니다.

## Spine SkeletonAnimation 파일 단위

### **기본 원칙: 유파(SwordArtStyle) 단위로 구성**

Spine SkeletonAnimation 애셋은 **유파별로 분리**하여 제작합니다. 하나의 유파는 하나의 SkeletonAnimation을 가지며, 그 안에 공용 애니메이션과 검술별 애니메이션이 모두 포함됩니다.

### **파일 구조**

```
Assets/Resources/Spine/
├── SwordArtStyles/                    # 유파별 Spine 애니메이션
│   ├── ImperialSword/                 # 제국 검술 유파
│   │   ├── skeleton.json              # Spine 스켈레톤 데이터
│   │   ├── skeleton.atlas.txt         # 텍스처 아틀라스 정보
│   │   ├── skeleton.png               # 텍스처 이미지
│   │   └── ImperialSword.asset        # Unity SkeletonDataAsset
│   ├── StreetBlade/                   # 길거리 무술 유파
│   │   ├── skeleton.json
│   │   ├── skeleton.atlas.txt
│   │   ├── skeleton.png
│   │   └── StreetBlade.asset
│   └── [새로운 유파]/
└── Characters/                         # 캐릭터별 특수 애니메이션
    ├── Player/
    └── Enemy/
```

### **SkeletonAnimation 내부 애니메이션 구성**

각 유파의 SkeletonAnimation에는 다음 애니메이션들이 포함됩니다:

#### **1. 공용 애니메이션 (Common Animations)**
- `idle` - 대기 상태
- `die` - 사망
- `behitted` - 피격
- `parry` - 쳐내기
- `guard` - 방어
- `interrupted` - 쳐내기 당함(중단)

#### **2. 검술 애니메이션 (Technique Animations)**
- `horizontal_slash` - 수평 베기
- `vertical_slash` - 수직 베기
- `thrust` - 찌르기
- `secret_art` - 오의
- `swing_double` - 이중 휘두르기 (테스트용)
- [기타 유파별 고유 검술]

## 구현 방식

### **1. 데이터 구조 연동**

```csharp
// SwordArtStyleData에 SkeletonDataAsset 필드 추가 필요
[Header("Spine 애니메이션")]
[SerializeField] private SkeletonDataAsset skeletonDataAsset;
public SkeletonDataAsset SkeletonDataAsset => skeletonDataAsset;

// ActionCommandData의 animationName은 해당 유파의 애니메이션 이름
[Header("Spine 애니메이션 설정")]
[Tooltip("이 커맨드에서 재생할 Spine 애니메이션 이름")]
public string animationName = ""; // 유파 SkeletonAnimation 내 애니메이션 이름
```

### **2. 애니메이션 재생 흐름**

1. **유파 장착**: `Combatant.EquipSwordArtStyle(styleData)`
2. **SkeletonAnimation 교체**: 유파 변경 시 해당 유파의 SkeletonDataAsset으로 교체
3. **검술 애니메이션 재생**: `SpineAttackTestAdapter.PlayForCommand(cmd)`에서 `cmd.animationName` 사용

### **3. 코드 예시**

```csharp
public class SpineAttackTestAdapter : MonoBehaviour
{
    [SerializeField] private SkeletonAnimation skeletonAnimation;
    
    public void PlayForCommand(ActionCommandData cmd)
    {
        // ActionCommandData의 animationName 사용
        string animName = cmd.animationName;
        
        if (string.IsNullOrEmpty(animName))
        {
            Debug.LogWarning($"커맨드 '{cmd.commandName}'에 animationName이 설정되지 않았습니다!");
            return;
        }
        
        // 현재 유파의 SkeletonAnimation에서 애니메이션 재생
        skeletonAnimation.AnimationState.SetAnimation(0, animName, false);
    }
}
```

## 현재 상태와 개선 계획

### **현재 상태**
- ✅ 유파별 검술 데이터 구조 (`SwordArtStyleData` + `ActionCommandData`)
- ✅ Spine 애니메이션 연동 시스템 (`SpineAttackTestAdapter`)
- ⚠️ 더미 유파 애니메이션만 존재 (`dummyAnim.asset`)
- ❌ 유파별 SkeletonAnimation 분리 미완성

### **개선 계획**

#### **Phase 1: 유파별 SkeletonAnimation 생성**
1. `ImperialSword.asset` - 제국 검술 유파
2. `StreetBlade.asset` - 길거리 무술 유파
3. 각 유파별 고유한 포즈와 스타일 반영

#### **Phase 2: 공용 애니메이션 추가**
1. `idle`, `die`, `behitted`, `parry`, `guard`, `interrupted`
2. 유파별로 다른 기본 포즈와 스타일 적용

#### **Phase 3: 검술 애니메이션 확장**
1. 기존 `swing_double` → 유파별 고유 검술 애니메이션으로 교체
2. 새로운 검술 추가 시 해당 유파의 SkeletonAnimation에 애니메이션 추가

## 명명 규칙

### **파일명**
- 유파: `[유파명].asset` (예: `ImperialSword.asset`)
- 폴더: `[유파명]/` (예: `ImperialSword/`)

### **애니메이션명**
- 공용: `idle`, `die`, `behitted`, `parry`, `guard`, `interrupted`
- 검술: `horizontal_slash`, `vertical_slash`, `thrust`, `secret_art`
- 테스트: `swing_double` (임시, 나중에 제거)

## 장점

1. **일관성**: 유파별 고유한 스타일과 포즈 유지
2. **효율성**: 하나의 SkeletonAnimation으로 모든 애니메이션 관리
3. **확장성**: 새로운 유파 추가 시 해당 스타일의 모든 애니메이션을 한 번에 관리
4. **성능**: 유파 전환 시 하나의 애셋만 로드/언로드
5. **유지보수**: 유파별로 애니메이션을 독립적으로 관리

## 주의사항

1. **애니메이션 이름 일치**: `ActionCommandData.animationName`과 실제 Spine 애니메이션 이름이 정확히 일치해야 함
2. **유파 전환 시 처리**: 유파 변경 시 SkeletonAnimation 컴포넌트의 SkeletonDataAsset 교체 필요
3. **메모리 관리**: 사용하지 않는 유파의 SkeletonAnimation은 언로드 고려
4. **에디터 지원**: Unity 에디터에서 유파별 애니메이션 미리보기 기능 추가 고려
